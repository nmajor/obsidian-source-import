#!/usr/bin/env bash
__dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

VAULT_PATH=`cat $__dir/.vault-path`

if [ -z "$VAULT_PATH" ]; then
    echo "No vault path set. Please run set-vault-path first."
    exit 1
fi

echo "Linking vault at $VAULT_PATH"

cd $__dir/..
DIR_NAME=${PWD##*/}
DIR_PATH=$PWD
VAULT_PLUGIN_PATH=$VAULT_PATH/.obsidian/plugins/$DIR_NAME

rm -rf $VAULT_PLUGIN_PATH
ln -s $PWD $VAULT_PLUGIN_PATH

echo "Linked vault at $VAULT_PATH"